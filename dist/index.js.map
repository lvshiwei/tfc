{"version":3,"file":"index.js","sources":["../src/lib/asserts.js","../src/JsonMockDescription.js","../src/parseJsonMock.js","../src/TypeDescriptor.js","../src/parseYupSchema.js","../src/constants.js","../src/prepareGenerateYupSchema.js","../src/generateYupSchema.js","../src/generateFormUI.js","../src/SchemaDescription.js","../src/traverseYupSchemaAst.js","../src/index.js"],"sourcesContent":["export const isNull = v => v === null;\nexport const isUndefined = v => typeof v === \"undefined\";\nexport const isNullOrUndefined = v => isNull(v) || isUndefined(v);\n\nexport const isNotEmptyArray = v => Array.isArray(v) && v.length > 0;\nexport const isArrayButEmpty = v => Array.isArray(v) && v.length === 0;\n\nexport const isNotEmptyString = v => typeof v === \"string\" && v.length > 0;\nexport const isStringButEmpty = v => isNullOrUndefined(v) || v === \"\";\n\nexport const isPositiveNumber = v => typeof v === \"number\" && v > 0;\nexport const isNegativeNumber = v => typeof v === \"number\" && v < 0;\nexport const isRealNumber = v =>\n  v === 0 || isPositiveNumber(v) || isNegativeNumber(v);\n\nexport const isFunction = v => typeof v === \"function\";\n","import { isNotEmptyString } from \"./lib/asserts\";\n\n/**\n * Json Mock 描述文档\n */\nexport class JsonMockDescription {\n  constructor() {\n    this.properties = [];\n  }\n}\n\n/**\n * Json Mock 字段属性描述\n */\nexport class JsonMockPropertyDescriptor {\n  constructor(key, value, annotations = []) {\n    this.key = key;\n    this.value = value;\n    this.annotations = annotations;\n  }\n}\n\n/**\n * Json Mock 申明指令\n */\nexport class JsonMockPropertyAnnotation {\n  constructor(header, body) {\n    this.header = header;\n    this.body = body;\n    this.parameters = [];\n  }\n\n  get method() {\n    return this.header.substring(1);\n  }\n}\n\nexport class JsonMockPropertyNothingAnnotation extends JsonMockPropertyDescriptor {\n  constructor() {\n    super(null, []);\n  }\n}\n","import fs from \"fs\";\nimport traverse from \"@babel/traverse\";\nimport { parse } from \"@babel/parser\";\nimport {\n  isNotEmptyArray,\n  isNullOrUndefined,\n  isNotEmptyString,\n} from \"./lib/asserts\";\nimport {\n  JsonMockDescription,\n  JsonMockPropertyDescriptor,\n  JsonMockPropertyAnnotation,\n} from \"./JsonMockDescription\";\n\n/**\n * 解析JSON mock脚本文档, 生成描述文档\n * @param {}} file\n * @param {*} encoding\n */\nexport default function (file, encoding = \"utf8\") {\n  return new Promise((resolve, reject) => {\n    fs.readFile(file, encoding, function (err, contents) {\n      if (err) {\n        console.error(err);\n        reject(err);\n        return;\n      }\n\n      const doc = parse(contents, { sourceType: \"module\" });\n      const description = parseJsonMockAST(doc);\n\n      resolve(description);\n    });\n  });\n}\n\n/**\n * 解析Json Mock脚本语法术, 生成描述文档\n * @param {ast} jsonASTDocument\n */\nexport function parseJsonMockAST(jsonASTDocument) {\n  const description = new JsonMockDescription();\n\n  const propertyVisitor = {\n    ObjectProperty(path) {\n      const property = parseJsonMockProperty(path.node);\n      description.properties.push(property);\n    },\n  };\n\n  traverse(jsonASTDocument, {\n    ExportDefaultDeclaration(path) {\n      path.traverse({\n        ObjectExpression(path) {\n          path.traverse(propertyVisitor);\n        },\n      });\n    },\n  });\n\n  return description;\n}\n\n/**\n * 解析抽象语法节点\n * @param {Node} astNode ast 节点\n */\nexport function parseJsonMockProperty(astNode) {\n  const { key, value, leadingComments } = astNode;\n  const anotations = leadingComments\n    .map((comment) => parseAnnotation(key.name, comment))\n    .filter((i) => !isNullOrUndefined(i));\n\n  return new JsonMockPropertyDescriptor(key.name, value.value, anotations);\n}\n/**\n * 解析申明\n * @param {*} text\n */\nexport function parseAnnotation(key, leadingComment) {\n  if (leadingComment.value.trim() === \"\") {\n    return null;\n  }\n\n  const r = /\\s*(\\S*)\\s(.*)/;\n  const matches = leadingComment.value.match(r);\n\n  if (isNotEmptyArray(matches)) {\n    const [, b, c] = matches;\n    let header, body;\n    if (isNotEmptyString(b)) {\n      header = b.trim();\n      body = c.trim();\n    } else if (b === \"\" && c.includes(\"@\")) {\n      header = c.trim();\n      body = null;\n    } else {\n      header = \"@label\";\n      body = c.trim();\n    }\n\n    return new JsonMockPropertyAnnotation(header, body);\n  } else {\n    return new JsonMockPropertyAnnotation(\"@label\", key);\n  }\n}\n","import { isNotEmptyArray } from \"./lib/asserts\";\n\nexport class TypeDescriptor {\n  constructor(name) {\n    this.name = name;\n  }\n\n  toString() {\n    return this.name;\n  }\n\n  static parse(ast) {\n    const { node } = ast;\n    const name = node.callee.name || node.callee.property.name;\n    if (name === \"label\") {\n      return new LabelDescriptor(name, ast);\n    } else {\n      return new TypeDescriptor(name);\n    }\n  }\n}\n\nexport class LabelDescriptor extends TypeDescriptor {\n  constructor(name, ast) {\n    super(name);\n    this.value = isNotEmptyArray(ast.node.arguments)\n      ? ast.node.arguments[0].value\n      : null;\n\n    return this;\n  }\n\n  toString() {\n    return this.name + \": \" + this.value;\n  }\n}\n","import fs from \"fs\";\nimport { isNullOrUndefined } from \"./lib/asserts\";\nimport { parse } from \"@babel/parser\";\nimport traverse from \"@babel/traverse\";\nimport * as t from \"@babel/types\";\nimport { TypeDescriptor } from \"./TypeDescriptor\";\n\nexport default function (file, encoding = \"utf8\") {\n  return new Promise((resolve, reject) => {\n    fs.readFile(file, encoding, function (err, contents) {\n      if (err) {\n        console.error(\"Yup schema parse error\", err);\n        reject(err);\n        return;\n      }\n\n      const doc = parse(contents, { sourceType: \"module\" });\n      const schema = {};\n\n      const isCalleeNode = (node, name) =>\n        t.isIdentifier(node.callee, { name }) ||\n        (t.isMemberExpression(node.callee) &&\n          t.isIdentifier(node.callee.property, { name }));\n\n      const isRootNode = (node) => isCalleeNode(node, \"object\");\n\n      const typeVisitor = {\n        CallExpression(path) {\n          const { parentKey } = path;\n          if (parentKey === \"arguments\") {\n            path.skip();\n            return;\n          }\n\n          const td = TypeDescriptor.parse(path);\n          if (!isNullOrUndefined(td)) {\n            schema[this.key].push(td);\n          } else {\n            console.error(\"parse error:\", this.key);\n          }\n        },\n        ObjectProperty(path) {\n          path.skip();\n        },\n      };\n      const propertyVisitor = {\n        ObjectProperty(path) {\n          const { key } = path.node;\n          if (\n            key.name === \"is\" ||\n            key.name === \"then\" ||\n            key.name === \"otherwise\"\n          ) {\n            path.skip();\n            return;\n          }\n\n          schema[key.name] = [];\n\n          path.traverse(typeVisitor, { key: key.name });\n        },\n      };\n\n      const rootVisitor = {\n        ObjectExpression(path) {\n          const { parentKey, parent } = path;\n          if (parentKey === \"arguments\" && isRootNode(parent)) {\n            path.traverse(propertyVisitor);\n            return;\n          }\n        },\n      };\n\n      traverse(doc, {\n        CallExpression(p) {\n          const { node } = p;\n          if (isRootNode(node)) {\n            p.traverse(rootVisitor);\n          }\n        },\n      });\n\n      resolve(schema);\n    });\n  });\n}\n","export const YUP_TYPE_STRING = 'string';\nexport const YUP_TYPE_Number = 'number';\nexport const YUP_TYPE_BOOL = 'bool';\nexport const YUP_TYPE_DATE = 'date';\nexport const YUP_TYPE_ARRAY = 'array';\nexport const YUP_TYPE_MIXED = 'mixed';\nexport const YUP_KEYWORD_REQUIRED = 'required';\n/**\n * YUP合法的指令集\n */\nexport const YUP_TYPE_LIST = [\n  YUP_TYPE_MIXED,\n  YUP_TYPE_STRING,\n  YUP_TYPE_Number,\n  YUP_TYPE_DATE,\n  YUP_TYPE_ARRAY,\n  YUP_TYPE_BOOL,\n];\n","/**\n * @overview 生成Yup Schema前的准备和预处理工作\n * @author shiwei.lv\n */\n\nimport { isNullOrUndefined, isNotEmptyString } from \"./lib/asserts\";\nimport { JsonMockPropertyAnnotation } from \"./JsonMockDescription\";\nimport { YUP_TYPE_LIST } from \"./constants\";\n/**\n * 检查指令是否支持\n */\nconst isSupported = (d) => YUP_TYPE_LIST.includes(d);\n/**\n * 生成Yup Schema前的准备和预处理工作\n * @param {JsonMockDescription} jsonMockDescription 描述对象\n */\nexport default function (jsonMockDescription) {\n  console.log(\"preparing >>>>>>>>\");\n  for (const property of jsonMockDescription.properties) {\n    ensureKeyAnnotation(property);\n    sortAnnotations(property);\n    preciselyAnnotationParameters(property);\n  }\n  // debugger;\n}\n\nfunction ensureKeyAnnotation(property) {\n  const found = property.annotations.find((a) => isSupported(a.method));\n  if (!isNullOrUndefined(found)) {\n    return found.method;\n  }\n\n  const type = detect(property.value);\n  const annotation = new JsonMockPropertyAnnotation(type);\n\n  property.annotations.push(annotation);\n\n  function detect(value) {\n    const b = /^(true|false)$/i;\n    const d = /^[0-9]?$/;\n    const f = /^[1-9]d*.d*|0.d*[1-9]d*$/;\n\n    if (b.test(value)) return \"@bool\";\n    if (d.test(value)) return \"@number\";\n    if (f.test(value)) return \"@number\";\n\n    return \"@string\";\n  }\n\n  return annotation.method;\n}\n/**\n * 排序\n */\nfunction sortAnnotations(property) {\n  const index = property.annotations.findIndex((a) => isSupported(a.method));\n  if (index > -1) {\n    const annotation = property.annotations[index];\n    property.annotations.splice(index, 1);\n    property.annotations.push(annotation);\n  }\n}\n\n/**\n * 参数精准化\n * @param {*} property\n */\nfunction preciselyAnnotationParameters(property) {\n  function cast(value) {\n    const b = /^(true|false)$/i;\n    const d = /^[0-9]?$/;\n    const f = /^[1-9]d*.d*|0.d*[1-9]d*$/;\n    const t = /^[1-9]\\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/;\n\n    if (b.test(value)) {\n      return Boolean(value);\n    }\n    if (t.test(value)) {\n      return new Date(value);\n    }\n    if (d.test(value)) {\n      return Number(value);\n    }\n    if (f.test(value)) {\n      return Number(value);\n    }\n\n    return String(value);\n  }\n\n  for (const annotation of property.annotations) {\n    const params = annotation.body;\n    if (isNotEmptyString(params)) {\n      annotation.parameters = params.split(\",\").map((s) => cast(s.trim()));\n    }\n  }\n}\n","import * as t from '@babel/types';\nimport generate from '@babel/generator';\nimport { parse } from '@babel/parser';\nimport { YUP_TYPE_LIST } from './constants';\nimport { isNotEmptyArray } from './lib/asserts';\nimport { JsonMockDescription } from './JsonMockDescription';\nimport prepareGenerateYupSchema from './prepareGenerateYupSchema';\n\n/**\n * 生成 Yup 验证架构脚本\n * @param {JsonMockDescription} description 描述文档\n */\nexport default function (description) {\n  return new Promise((resolve, reject) => {\n    if (!(description instanceof JsonMockDescription)) {\n      console.error('不能生成yup验证规则, 收到的参数不符合预期!');\n      reject();\n      return;\n    }\n\n    const code = `\n  /**\n   * @overview A Yup schema generated by tfc.\n   */\n  import { object, mixed, date, string, number, array } from \"yup\";\n\n  export default object();\n  `;\n\n    const ast = parse(code, { sourceType: 'module' });\n    const objectDeclare = ast.program.body[1].declaration;\n\n    const objectProperties = [];\n\n    prepareGenerateYupSchema(description);\n\n    for (const property of description.properties) {\n      const rules = buildRulesChain(property);\n      objectProperties.push(\n        t.objectProperty(t.identifier(property.key), rules),\n      );\n    }\n    objectDeclare.arguments.push(t.objectExpression(objectProperties));\n\n    const output = generate(ast, {}, code);\n    const text = ensureReadableText(output.code);\n\n    resolve(text);\n  });\n}\n\n/**\n * 构建规则链\n */\nexport function buildRulesChain(property) {\n  if (isNotEmptyArray(property.annotations)) {\n    return makeRuleExpression(property.annotations, 0);\n  }\n\n  console.warn('无法构建规则, property 参数是空的!');\n}\n\nfunction makeRuleExpression(annotations, index) {\n  if (annotations.length === 1 || index === annotations.length - 1) {\n    const ann = annotations[index];\n\n    return t.callExpression(t.identifier(ann.method), makeRuleArguments(ann));\n  }\n\n  const ann = annotations[index];\n  return t.callExpression(\n    t.memberExpression(\n      makeRuleExpression(annotations, index + 1),\n      t.identifier(ann.method),\n    ),\n    makeRuleArguments(annotations[index]),\n  );\n}\n/**\n * 构建规则参数\n */\nfunction makeRuleArguments(annotation) {\n  function cast(value) {\n    const type = typeof value;\n    switch (type) {\n      case 'string':\n        return t.stringLiteral(value);\n      case 'number':\n        return t.numericLiteral(value);\n      case 'boolean':\n        return t.booleanLiteral(value);\n      default:\n        return t.stringLiteral(value);\n    }\n  }\n\n  return annotation.parameters.map(cast);\n}\n\n/**\n * 将unicode字符转化成可读的汉字\n * @param {*} unicodeText\n */\nfunction ensureReadableText(unicodeText) {\n  const r = /\\\\u([\\d\\w]{4})/gi;\n  const dest = unicodeText.replace(r, function (match, grp) {\n    return String.fromCharCode(parseInt(grp, 16));\n  });\n  return decodeURIComponent(dest);\n}\n","import * as t from '@babel/types';\nimport generate from '@babel/generator';\nimport { parse } from '@babel/parser';\nimport { LabelDescriptor } from './TypeDescriptor';\n\nexport default function (schema) {\n  const code = `\n  /**\n   * @overview A form component generated by tfc.\n   * @author your.name@corp.com\n   */\n  import React from \"react\";\n  import classnames from \"classnames\";\n  import schema from \"./schema\";\n  import { useModel, useValidation } from \"./hooks\";\n  import { Card, List, InputItem, Picker, DatePicker } from \"antd-mobile\";\n\n  /**\n   * Say something to avoid warnning from eslint\n   */\n  export default function () {\n    const [model, setModel] = useModel({ preOpeningTime: new Date() });\n    const [validate, errors] = useValidation(schema);\n  \n    const handleSubmit = () =>\n      validate(model)\n        .then(() => alert(\"Amazing!!\"))\n        .catch(console.error);\n  \n    const handleChangeInput = (name) => (value) => setModel(name, value);\n    const handleLeaveInput = (name) => () => validate(name, model[name]);\n    const handleChangeSelect = (name) => (value) => {\n      setModel(name, value);\n      validate(name, value);\n    };\n    const renderClassName = (name, properties) =>\n      classnames(...(properties || []), {\n        error: Array.isArray(errors) && errors.some((e) => e.path === name),\n        hasValue: !(model[name] === null || typeof model[name] === \"undefined\"),\n      });\n\n    const Required = () => <i className=\"required\">*</i>;\n  }`;\n  const ast = parse(code, { sourceType: 'module', plugins: ['jsx'] });\n  const exportDefault = ast.program.body.find(t.isExportDefaultDeclaration);\n\n  const newline = t.jsxText('\\n');\n  const div = t.jsxIdentifier('div');\n  const divOpen = t.jsxOpeningElement(div, []);\n  const divClose = t.jsxClosingElement(div);\n  const list = t.jsxIdentifier('List');\n  const listComp = t.jsxElement(\n    t.jsxOpeningElement(list, []),\n    t.jsxClosingElement(list),\n    [newline],\n  );\n  for (const key in schema) {\n    const item = t.jsxIdentifier('InputItem');\n    const itemComp = t.jsxElement(\n      t.jsxOpeningElement(item, [\n        t.jsxAttribute(t.jsxIdentifier('name'), t.stringLiteral(key)),\n\n        t.jsxAttribute(\n          t.jsxIdentifier('className'),\n          t.jsxExpressionContainer(\n            t.callExpression(t.identifier('renderClassName'), [\n              t.stringLiteral(key),\n            ]),\n          ),\n        ),\n\n        t.jsxAttribute(\n          t.jsxIdentifier('onChange'),\n          t.jsxExpressionContainer(\n            t.callExpression(t.identifier('handleChangeInput'), [\n              t.stringLiteral(key),\n            ]),\n          ),\n        ),\n      ]),\n      t.jsxClosingElement(item),\n      [],\n    );\n    const rules = schema[key];\n    const labelDesc = schema[key].find((i) => i instanceof LabelDescriptor);\n    if (labelDesc) {\n      itemComp.children.push(t.jsxText(labelDesc.value));\n    }\n    const typeDesc = rules.slice(-1)[0];\n    if (['string', 'number'].includes(typeDesc.name)) {\n      itemComp.openingElement.attributes.push(\n        t.jsxAttribute(\n          t.jsxIdentifier('onBlur'),\n          t.jsxExpressionContainer(\n            t.callExpression(t.identifier('handleLeaveInput'), [\n              t.stringLiteral(key),\n            ]),\n          ),\n        ),\n      );\n    }\n\n    const isRequired = rules.some((r) => r.name === 'required');\n    if (isRequired) {\n      itemComp.children.push(\n        t.jsxElement(\n          t.jsxOpeningElement(t.jsxIdentifier('Required'), [], true),\n          null,\n          [],\n          true,\n        ),\n      );\n    }\n\n    listComp.children.push(itemComp);\n    listComp.children.push(newline);\n  }\n\n  const jsxroot = t.jsxElement(divOpen, divClose, [newline, listComp, newline]);\n\n  const returnStatement = t.returnStatement(jsxroot);\n  exportDefault.declaration.body.body.push(returnStatement);\n  const output = generate(ast, {}, code);\n\n  return output.code;\n}\n","/**\n * @overview 规则描述文档, 用于生成表单\n * @author shiwei.lv\n */\n\nimport { YUP_TYPE_LIST, YUP_KEYWORD_REQUIRED } from './constants';\nimport { isNullOrUndefined } from './lib/asserts';\n\nexport default class AbstractSchemaDescription {\n  constructor() {\n    this.rules = [];\n  }\n}\n\nexport class YupSchemaDescription extends AbstractSchemaDescription {\n  constructor() {\n    super();\n  }\n}\n\nexport class YupSchemaRuleDescriptor {\n  constructor(name, attributes = []) {\n    this.name = name;\n    this.attributes = attributes;\n    this._type = null;\n  }\n\n  get type() {\n    if (isNullOrUndefined(this._type)) {\n      return this._type;\n    }\n\n    const found = this.attributes.find(({ key }) =>\n      YUP_TYPE_LIST.includes(key),\n    );\n\n    if (!isNullOrUndefined(found)) {\n      this._type = found.key;\n    }\n  }\n\n  isRequired() {\n    return this.attributes.some(({ key }) => key === YUP_KEYWORD_REQUIRED);\n  }\n}\n\nexport class YupSchemaRuleAttributeDescription {\n  constructor(key, values = []) {\n    this.key = key;\n    this.values = values;\n  }\n}\n","/**\n * @overview Yup Schema traverser\n * @author shiwei.lv\n */\n\nimport {\n  YupSchemaDescription,\n  YupSchemaRuleDescriptor,\n  YupSchemaRuleAttributeDescription,\n} from './SchemaDescription';\nimport traverse from '@babel/traverse';\nimport * as t from '@babel/types';\n/**\n * Yup schema\n * @param {*} ast abstract syntax object\n */\nexport default function (ast) {\n  try {\n    let meetExportDefaultObjectNode = false;\n    const desc = new YupSchemaDescription();\n\n    traverse(ast, {\n      ExportDefaultDeclaration(path) {\n        const { declaration: objectNode } = path.node;\n        if (\n          t.isCallExpression(objectNode) &&\n          t.isIdentifier(objectNode.callee) &&\n          objectNode.callee.name === 'object'\n        ) {\n          console.info('> got object node in ast document');\n          meetExportDefaultObjectNode = true;\n\n          for (const property of objectNode.arguments[0].properties) {\n            const { key, value } = property;\n            const attributes = [];\n            traverseRules(value, attributes);\n            const rule = new YupSchemaRuleDescriptor(key.name);\n            rule.attributes = attributes;\n\n            desc.rules.push(rule);\n          }\n\n          debugger;\n        }\n      },\n    });\n\n    if (meetExportDefaultObjectNode) {\n      console.log('done.');\n\n      return desc;\n    } else {\n      console.error(\n        'did not meet export default object call expression. failed!',\n      );\n    }\n  } catch (e) {\n    console.error('can not visit AST document');\n    console.error(e);\n  }\n}\n\nfunction traverseRules(value, attributes) {\n  if (t.isCallExpression(value)) {\n    const { callee } = value;\n    if (t.isIdentifier(callee)) {\n      const { name } = callee;\n      attributes.push(new YupSchemaRuleAttributeDescription(name));\n\n      return;\n    } else if (t.isMemberExpression(callee)) {\n      const { object, property } = callee;\n      attributes.push(new YupSchemaRuleAttributeDescription(property.name));\n\n      traverseRules(object, attributes);\n    }\n  }\n}\n","import fs from 'fs';\n\nimport parseJsonMock from './parseJsonMock';\nimport parseYupSchema from './parseYupSchema';\nimport generateYupSchema from './generateYupSchema';\nimport generateFormUI from './generateFormUI';\nimport { parse } from '@babel/parser';\nimport traverseYupSchemaAst from './traverseYupSchemaAst';\nimport { isNullOrUndefined } from './lib/asserts';\n\nexport function jsonMock2YupSchema(file, encoding = 'utf8') {\n  console.info('==== parse JSON mock data and generate Yup schema ====');\n\n  parseJsonMock(file, encoding).then((description) => {\n    generateYupSchema(description).then((schema) => {\n      console.log(schema);\n\n      fs.writeFile(__dirname + '/schema.js', schema, encoding, function (err) {\n        if (err) {\n          return console.error(err);\n        }\n        console.log('schema.js was updated');\n      });\n    });\n  });\n}\n\nexport function yupSchema2FormUI(file, encoding = 'utf8') {\n  console.info('==== parse Yup schema and generate form UI ====');\n\n  parseYupSchema(file, encoding).then((schema) => {\n    console.log(schema);\n    const code = generateFormUI(schema);\n    console.log(code);\n  });\n}\n\nexport function traverseYupSchema(file, encoding = 'utf8') {\n  fs.readFile(file, encoding, function (err, contents) {\n    if (err) {\n      console.error(err);\n      reject(err);\n      return;\n    }\n\n    const ast = parse(contents, { sourceType: 'module' });\n    if (!isNullOrUndefined(ast)) {\n      traverseYupSchemaAst(ast);\n    }\n  });\n}\n\nexport function go(file, encoding = 'utf8') {\n  parseJsonMock(file, encoding).then((description) => {\n    generateYupSchema(description).then((schema) => {\n      fs.writeFile(__dirname + '/schema.js', schema, encoding, function (err) {\n        if (err) {\n          return console.error(err);\n        }\n        console.log('schema.js was updated');\n      });\n\n      parseYupSchema(__dirname + '/schema.js').then((schema) => {\n        const code = generateFormUI(schema);\n\n        fs.writeFile(__dirname + '/form.jsx', code, encoding, function (err) {\n          if (err) {\n            return console.error(err);\n          }\n          console.log('form.jsx was updated');\n          console.log('done.');\n        });\n      });\n    });\n  });\n}\n"],"names":["isNull","v","isUndefined","isNullOrUndefined","isNotEmptyArray","Array","isArray","length","isNotEmptyString","JsonMockDescription","properties","JsonMockPropertyDescriptor","key","value","annotations","JsonMockPropertyAnnotation","header","body","parameters","substring","file","encoding","Promise","resolve","reject","fs","readFile","err","contents","console","error","doc","parse","sourceType","description","parseJsonMockAST","jsonASTDocument","propertyVisitor","ObjectProperty","path","property","parseJsonMockProperty","node","push","traverse","ExportDefaultDeclaration","ObjectExpression","astNode","leadingComments","anotations","map","comment","parseAnnotation","name","filter","i","leadingComment","trim","r","matches","match","b","c","includes","TypeDescriptor","ast","callee","LabelDescriptor","arguments","schema","isCalleeNode","t","isRootNode","typeVisitor","CallExpression","parentKey","skip","td","rootVisitor","parent","p","YUP_TYPE_STRING","YUP_TYPE_Number","YUP_TYPE_BOOL","YUP_TYPE_DATE","YUP_TYPE_ARRAY","YUP_TYPE_MIXED","YUP_KEYWORD_REQUIRED","YUP_TYPE_LIST","isSupported","d","jsonMockDescription","log","ensureKeyAnnotation","sortAnnotations","preciselyAnnotationParameters","found","find","a","method","type","detect","annotation","f","test","index","findIndex","splice","cast","Boolean","Date","Number","String","params","split","s","code","objectDeclare","program","declaration","objectProperties","prepareGenerateYupSchema","rules","buildRulesChain","output","generate","text","ensureReadableText","makeRuleExpression","warn","ann","makeRuleArguments","unicodeText","dest","replace","grp","fromCharCode","parseInt","decodeURIComponent","plugins","exportDefault","newline","div","divOpen","divClose","list","listComp","item","itemComp","labelDesc","children","typeDesc","slice","openingElement","attributes","isRequired","some","jsxroot","returnStatement","AbstractSchemaDescription","YupSchemaDescription","YupSchemaRuleDescriptor","_type","YupSchemaRuleAttributeDescription","values","meetExportDefaultObjectNode","desc","objectNode","info","traverseRules","rule","e","object","jsonMock2YupSchema","parseJsonMock","then","generateYupSchema","writeFile","__dirname","yupSchema2FormUI","parseYupSchema","generateFormUI","traverseYupSchema","traverseYupSchemaAst","go"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAO,IAAMA,MAAM,GAAG,SAATA,MAAS,CAAAC,CAAC;AAAA,SAAIA,CAAC,KAAK,IAAV;AAAA,CAAhB;AACA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAAAD,CAAC;AAAA,SAAI,OAAOA,CAAP,KAAa,WAAjB;AAAA,CAArB;AACA,IAAME,iBAAiB,GAAG,SAApBA,iBAAoB,CAAAF,CAAC;AAAA,SAAID,MAAM,CAACC,CAAD,CAAN,IAAaC,WAAW,CAACD,CAAD,CAA5B;AAAA,CAA3B;AAEA,IAAMG,eAAe,GAAG,SAAlBA,eAAkB,CAAAH,CAAC;AAAA,SAAII,KAAK,CAACC,OAAN,CAAcL,CAAd,KAAoBA,CAAC,CAACM,MAAF,GAAW,CAAnC;AAAA,CAAzB;AAGA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAAP,CAAC;AAAA,SAAI,OAAOA,CAAP,KAAa,QAAb,IAAyBA,CAAC,CAACM,MAAF,GAAW,CAAxC;AAAA,CAA1B;;ACLP;;;;IAGaE,mBAAb,GACE,+BAAc;AAAA;;AACZ,OAAKC,UAAL,GAAkB,EAAlB;AACD,CAHH;AAMA;;;;IAGaC,0BAAb,GACE,oCAAYC,GAAZ,EAAiBC,KAAjB,EAA0C;AAAA,MAAlBC,WAAkB,uEAAJ,EAAI;;AAAA;;AACxC,OAAKF,GAAL,GAAWA,GAAX;AACA,OAAKC,KAAL,GAAaA,KAAb;AACA,OAAKC,WAAL,GAAmBA,WAAnB;AACD,CALH;AAQA;;;;IAGaC,0BAAb;AACE,sCAAYC,MAAZ,EAAoBC,IAApB,EAA0B;AAAA;;AACxB,SAAKD,MAAL,GAAcA,MAAd;AACA,SAAKC,IAAL,GAAYA,IAAZ;AACA,SAAKC,UAAL,GAAkB,EAAlB;AACD;;AALH;AAAA;AAAA,wBAOe;AACX,aAAO,KAAKF,MAAL,CAAYG,SAAZ,CAAsB,CAAtB,CAAP;AACD;AATH;;AAAA;AAAA;;ACXA;;;;;;AAKe,wBAAUC,IAAV,EAAmC;AAAA,MAAnBC,QAAmB,uEAAR,MAAQ;AAChD,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCC,IAAAA,EAAE,CAACC,QAAH,CAAYN,IAAZ,EAAkBC,QAAlB,EAA4B,UAAUM,GAAV,EAAeC,QAAf,EAAyB;AACnD,UAAID,GAAJ,EAAS;AACPE,QAAAA,OAAO,CAACC,KAAR,CAAcH,GAAd;AACAH,QAAAA,MAAM,CAACG,GAAD,CAAN;AACA;AACD;;AAED,UAAMI,GAAG,GAAGC,YAAK,CAACJ,QAAD,EAAW;AAAEK,QAAAA,UAAU,EAAE;AAAd,OAAX,CAAjB;AACA,UAAMC,WAAW,GAAGC,gBAAgB,CAACJ,GAAD,CAApC;AAEAR,MAAAA,OAAO,CAACW,WAAD,CAAP;AACD,KAXD;AAYD,GAbM,CAAP;AAcD;AAED;;;;;AAIO,SAASC,gBAAT,CAA0BC,eAA1B,EAA2C;AAChD,MAAMF,WAAW,GAAG,IAAIzB,mBAAJ,EAApB;AAEA,MAAM4B,eAAe,GAAG;AACtBC,IAAAA,cADsB,0BACPC,IADO,EACD;AACnB,UAAMC,QAAQ,GAAGC,qBAAqB,CAACF,IAAI,CAACG,IAAN,CAAtC;AACAR,MAAAA,WAAW,CAACxB,UAAZ,CAAuBiC,IAAvB,CAA4BH,QAA5B;AACD;AAJqB,GAAxB;AAOAI,EAAAA,QAAQ,CAACR,eAAD,EAAkB;AACxBS,IAAAA,wBADwB,oCACCN,IADD,EACO;AAC7BA,MAAAA,IAAI,CAACK,QAAL,CAAc;AACZE,QAAAA,gBADY,4BACKP,IADL,EACW;AACrBA,UAAAA,IAAI,CAACK,QAAL,CAAcP,eAAd;AACD;AAHW,OAAd;AAKD;AAPuB,GAAlB,CAAR;AAUA,SAAOH,WAAP;AACD;AAED;;;;;AAIO,SAASO,qBAAT,CAA+BM,OAA/B,EAAwC;AAAA,MACrCnC,GADqC,GACLmC,OADK,CACrCnC,GADqC;AAAA,MAChCC,KADgC,GACLkC,OADK,CAChClC,KADgC;AAAA,MACzBmC,eADyB,GACLD,OADK,CACzBC,eADyB;AAE7C,MAAMC,UAAU,GAAGD,eAAe,CAC/BE,GADgB,CACZ,UAACC,OAAD;AAAA,WAAaC,eAAe,CAACxC,GAAG,CAACyC,IAAL,EAAWF,OAAX,CAA5B;AAAA,GADY,EAEhBG,MAFgB,CAET,UAACC,CAAD;AAAA,WAAO,CAACpD,iBAAiB,CAACoD,CAAD,CAAzB;AAAA,GAFS,CAAnB;AAIA,SAAO,IAAI5C,0BAAJ,CAA+BC,GAAG,CAACyC,IAAnC,EAAyCxC,KAAK,CAACA,KAA/C,EAAsDoC,UAAtD,CAAP;AACD;AACD;;;;;AAIO,SAASG,eAAT,CAAyBxC,GAAzB,EAA8B4C,cAA9B,EAA8C;AACnD,MAAIA,cAAc,CAAC3C,KAAf,CAAqB4C,IAArB,OAAgC,EAApC,EAAwC;AACtC,WAAO,IAAP;AACD;;AAED,MAAMC,CAAC,GAAG,gBAAV;AACA,MAAMC,OAAO,GAAGH,cAAc,CAAC3C,KAAf,CAAqB+C,KAArB,CAA2BF,CAA3B,CAAhB;;AAEA,MAAItD,eAAe,CAACuD,OAAD,CAAnB,EAA8B;AAAA,kCACXA,OADW;AAAA,QACnBE,CADmB;AAAA,QAChBC,CADgB;;AAE5B,QAAI9C,MAAJ,EAAYC,IAAZ;;AACA,QAAIT,gBAAgB,CAACqD,CAAD,CAApB,EAAyB;AACvB7C,MAAAA,MAAM,GAAG6C,CAAC,CAACJ,IAAF,EAAT;AACAxC,MAAAA,IAAI,GAAG6C,CAAC,CAACL,IAAF,EAAP;AACD,KAHD,MAGO,IAAII,CAAC,KAAK,EAAN,IAAYC,CAAC,CAACC,QAAF,CAAW,GAAX,CAAhB,EAAiC;AACtC/C,MAAAA,MAAM,GAAG8C,CAAC,CAACL,IAAF,EAAT;AACAxC,MAAAA,IAAI,GAAG,IAAP;AACD,KAHM,MAGA;AACLD,MAAAA,MAAM,GAAG,QAAT;AACAC,MAAAA,IAAI,GAAG6C,CAAC,CAACL,IAAF,EAAP;AACD;;AAED,WAAO,IAAI1C,0BAAJ,CAA+BC,MAA/B,EAAuCC,IAAvC,CAAP;AACD,GAfD,MAeO;AACL,WAAO,IAAIF,0BAAJ,CAA+B,QAA/B,EAAyCH,GAAzC,CAAP;AACD;AACF;;ICvGYoD,cAAb;AACE,0BAAYX,IAAZ,EAAkB;AAAA;;AAChB,SAAKA,IAAL,GAAYA,IAAZ;AACD;;AAHH;AAAA;AAAA,+BAKa;AACT,aAAO,KAAKA,IAAZ;AACD;AAPH;AAAA;AAAA,0BASeY,GATf,EASoB;AAAA,UACRvB,IADQ,GACCuB,GADD,CACRvB,IADQ;AAEhB,UAAMW,IAAI,GAAGX,IAAI,CAACwB,MAAL,CAAYb,IAAZ,IAAoBX,IAAI,CAACwB,MAAL,CAAY1B,QAAZ,CAAqBa,IAAtD;;AACA,UAAIA,IAAI,KAAK,OAAb,EAAsB;AACpB,eAAO,IAAIc,eAAJ,CAAoBd,IAApB,EAA0BY,GAA1B,CAAP;AACD,OAFD,MAEO;AACL,eAAO,IAAID,cAAJ,CAAmBX,IAAnB,CAAP;AACD;AACF;AAjBH;;AAAA;AAAA;IAoBac,eAAb;AAAA;;AAAA;;AACE,2BAAYd,IAAZ,EAAkBY,GAAlB,EAAuB;AAAA;;AAAA;;AACrB,8BAAMZ,IAAN;AACA,UAAKxC,KAAL,GAAaT,eAAe,CAAC6D,GAAG,CAACvB,IAAJ,CAAS0B,SAAV,CAAf,GACTH,GAAG,CAACvB,IAAJ,CAAS0B,SAAT,CAAmB,CAAnB,EAAsBvD,KADb,GAET,IAFJ;AAIA;AACD;;AARH;AAAA;AAAA,+BAUa;AACT,aAAO,KAAKwC,IAAL,GAAY,IAAZ,GAAmB,KAAKxC,KAA/B;AACD;AAZH;;AAAA;AAAA,EAAqCmD,cAArC;;ACfe,yBAAU5C,IAAV,EAAmC;AAAA,MAAnBC,QAAmB,uEAAR,MAAQ;AAChD,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCC,IAAAA,EAAE,CAACC,QAAH,CAAYN,IAAZ,EAAkBC,QAAlB,EAA4B,UAAUM,GAAV,EAAeC,QAAf,EAAyB;AACnD,UAAID,GAAJ,EAAS;AACPE,QAAAA,OAAO,CAACC,KAAR,CAAc,wBAAd,EAAwCH,GAAxC;AACAH,QAAAA,MAAM,CAACG,GAAD,CAAN;AACA;AACD;;AAED,UAAMI,GAAG,GAAGC,YAAK,CAACJ,QAAD,EAAW;AAAEK,QAAAA,UAAU,EAAE;AAAd,OAAX,CAAjB;AACA,UAAMoC,MAAM,GAAG,EAAf;;AAEA,UAAMC,YAAY,GAAG,SAAfA,YAAe,CAAC5B,IAAD,EAAOW,IAAP;AAAA,eACnBkB,cAAA,CAAe7B,IAAI,CAACwB,MAApB,EAA4B;AAAEb,UAAAA,IAAI,EAAJA;AAAF,SAA5B,KACCkB,oBAAA,CAAqB7B,IAAI,CAACwB,MAA1B,KACCK,cAAA,CAAe7B,IAAI,CAACwB,MAAL,CAAY1B,QAA3B,EAAqC;AAAEa,UAAAA,IAAI,EAAJA;AAAF,SAArC,CAHiB;AAAA,OAArB;;AAKA,UAAMmB,UAAU,GAAG,SAAbA,UAAa,CAAC9B,IAAD;AAAA,eAAU4B,YAAY,CAAC5B,IAAD,EAAO,QAAP,CAAtB;AAAA,OAAnB;;AAEA,UAAM+B,WAAW,GAAG;AAClBC,QAAAA,cADkB,0BACHnC,IADG,EACG;AAAA,cACXoC,SADW,GACGpC,IADH,CACXoC,SADW;;AAEnB,cAAIA,SAAS,KAAK,WAAlB,EAA+B;AAC7BpC,YAAAA,IAAI,CAACqC,IAAL;AACA;AACD;;AAED,cAAMC,EAAE,GAAGb,cAAc,CAAChC,KAAf,CAAqBO,IAArB,CAAX;;AACA,cAAI,CAACpC,iBAAiB,CAAC0E,EAAD,CAAtB,EAA4B;AAC1BR,YAAAA,MAAM,CAAC,KAAKzD,GAAN,CAAN,CAAiB+B,IAAjB,CAAsBkC,EAAtB;AACD,WAFD,MAEO;AACLhD,YAAAA,OAAO,CAACC,KAAR,CAAc,cAAd,EAA8B,KAAKlB,GAAnC;AACD;AACF,SAdiB;AAelB0B,QAAAA,cAfkB,0BAeHC,IAfG,EAeG;AACnBA,UAAAA,IAAI,CAACqC,IAAL;AACD;AAjBiB,OAApB;AAmBA,UAAMvC,eAAe,GAAG;AACtBC,QAAAA,cADsB,0BACPC,IADO,EACD;AAAA,cACX3B,GADW,GACH2B,IAAI,CAACG,IADF,CACX9B,GADW;;AAEnB,cACEA,GAAG,CAACyC,IAAJ,KAAa,IAAb,IACAzC,GAAG,CAACyC,IAAJ,KAAa,MADb,IAEAzC,GAAG,CAACyC,IAAJ,KAAa,WAHf,EAIE;AACAd,YAAAA,IAAI,CAACqC,IAAL;AACA;AACD;;AAEDP,UAAAA,MAAM,CAACzD,GAAG,CAACyC,IAAL,CAAN,GAAmB,EAAnB;AAEAd,UAAAA,IAAI,CAACK,QAAL,CAAc6B,WAAd,EAA2B;AAAE7D,YAAAA,GAAG,EAAEA,GAAG,CAACyC;AAAX,WAA3B;AACD;AAfqB,OAAxB;AAkBA,UAAMyB,WAAW,GAAG;AAClBhC,QAAAA,gBADkB,4BACDP,IADC,EACK;AAAA,cACboC,SADa,GACSpC,IADT,CACboC,SADa;AAAA,cACFI,MADE,GACSxC,IADT,CACFwC,MADE;;AAErB,cAAIJ,SAAS,KAAK,WAAd,IAA6BH,UAAU,CAACO,MAAD,CAA3C,EAAqD;AACnDxC,YAAAA,IAAI,CAACK,QAAL,CAAcP,eAAd;AACA;AACD;AACF;AAPiB,OAApB;AAUAO,MAAAA,QAAQ,CAACb,GAAD,EAAM;AACZ2C,QAAAA,cADY,0BACGM,CADH,EACM;AAAA,cACRtC,IADQ,GACCsC,CADD,CACRtC,IADQ;;AAEhB,cAAI8B,UAAU,CAAC9B,IAAD,CAAd,EAAsB;AACpBsC,YAAAA,CAAC,CAACpC,QAAF,CAAWkC,WAAX;AACD;AACF;AANW,OAAN,CAAR;AASAvD,MAAAA,OAAO,CAAC8C,MAAD,CAAP;AACD,KA1ED;AA2ED,GA5EM,CAAP;AA6ED;;ACrFM,IAAMY,eAAe,GAAG,QAAxB;AACA,IAAMC,eAAe,GAAG,QAAxB;AACA,IAAMC,aAAa,GAAG,MAAtB;AACA,IAAMC,aAAa,GAAG,MAAtB;AACA,IAAMC,cAAc,GAAG,OAAvB;AACA,IAAMC,cAAc,GAAG,OAAvB;AACA,IAAMC,oBAAoB,GAAG,UAA7B;AACP;;;;AAGO,IAAMC,aAAa,GAAG,CAC3BF,cAD2B,EAE3BL,eAF2B,EAG3BC,eAH2B,EAI3BE,aAJ2B,EAK3BC,cAL2B,EAM3BF,aAN2B,CAAtB;;ACFP;;;;AAGA,IAAMM,WAAW,GAAG,SAAdA,WAAc,CAACC,CAAD;AAAA,SAAOF,aAAa,CAACzB,QAAd,CAAuB2B,CAAvB,CAAP;AAAA,CAApB;AACA;;;;;;AAIe,mCAAUC,mBAAV,EAA+B;AAC5C9D,EAAAA,OAAO,CAAC+D,GAAR,CAAY,oBAAZ;;AAD4C,6CAErBD,mBAAmB,CAACjF,UAFC;AAAA;;AAAA;AAE5C,wDAAuD;AAAA,UAA5C8B,QAA4C;AACrDqD,MAAAA,mBAAmB,CAACrD,QAAD,CAAnB;AACAsD,MAAAA,eAAe,CAACtD,QAAD,CAAf;AACAuD,MAAAA,6BAA6B,CAACvD,QAAD,CAA7B;AACD,KAN2C;;AAAA;AAAA;AAAA;AAAA;AAAA;AAQ7C;;AAED,SAASqD,mBAAT,CAA6BrD,QAA7B,EAAuC;AACrC,MAAMwD,KAAK,GAAGxD,QAAQ,CAAC1B,WAAT,CAAqBmF,IAArB,CAA0B,UAACC,CAAD;AAAA,WAAOT,WAAW,CAACS,CAAC,CAACC,MAAH,CAAlB;AAAA,GAA1B,CAAd;;AACA,MAAI,CAAChG,iBAAiB,CAAC6F,KAAD,CAAtB,EAA+B;AAC7B,WAAOA,KAAK,CAACG,MAAb;AACD;;AAED,MAAMC,IAAI,GAAGC,MAAM,CAAC7D,QAAQ,CAAC3B,KAAV,CAAnB;AACA,MAAMyF,UAAU,GAAG,IAAIvF,0BAAJ,CAA+BqF,IAA/B,CAAnB;AAEA5D,EAAAA,QAAQ,CAAC1B,WAAT,CAAqB6B,IAArB,CAA0B2D,UAA1B;;AAEA,WAASD,MAAT,CAAgBxF,KAAhB,EAAuB;AACrB,QAAMgD,CAAC,GAAG,iBAAV;AACA,QAAM6B,CAAC,GAAG,UAAV;AACA,QAAMa,CAAC,GAAG,0BAAV;AAEA,QAAI1C,CAAC,CAAC2C,IAAF,CAAO3F,KAAP,CAAJ,EAAmB,OAAO,OAAP;AACnB,QAAI6E,CAAC,CAACc,IAAF,CAAO3F,KAAP,CAAJ,EAAmB,OAAO,SAAP;AACnB,QAAI0F,CAAC,CAACC,IAAF,CAAO3F,KAAP,CAAJ,EAAmB,OAAO,SAAP;AAEnB,WAAO,SAAP;AACD;;AAED,SAAOyF,UAAU,CAACH,MAAlB;AACD;AACD;;;;;AAGA,SAASL,eAAT,CAAyBtD,QAAzB,EAAmC;AACjC,MAAMiE,KAAK,GAAGjE,QAAQ,CAAC1B,WAAT,CAAqB4F,SAArB,CAA+B,UAACR,CAAD;AAAA,WAAOT,WAAW,CAACS,CAAC,CAACC,MAAH,CAAlB;AAAA,GAA/B,CAAd;;AACA,MAAIM,KAAK,GAAG,CAAC,CAAb,EAAgB;AACd,QAAMH,UAAU,GAAG9D,QAAQ,CAAC1B,WAAT,CAAqB2F,KAArB,CAAnB;AACAjE,IAAAA,QAAQ,CAAC1B,WAAT,CAAqB6F,MAArB,CAA4BF,KAA5B,EAAmC,CAAnC;AACAjE,IAAAA,QAAQ,CAAC1B,WAAT,CAAqB6B,IAArB,CAA0B2D,UAA1B;AACD;AACF;AAED;;;;;;AAIA,SAASP,6BAAT,CAAuCvD,QAAvC,EAAiD;AAC/C,WAASoE,IAAT,CAAc/F,KAAd,EAAqB;AACnB,QAAMgD,CAAC,GAAG,iBAAV;AACA,QAAM6B,CAAC,GAAG,UAAV;AACA,QAAMa,CAAC,GAAG,0BAAV;AACA,QAAMhC,CAAC,GAAG,yDAAV;;AAEA,QAAIV,CAAC,CAAC2C,IAAF,CAAO3F,KAAP,CAAJ,EAAmB;AACjB,aAAOgG,OAAO,CAAChG,KAAD,CAAd;AACD;;AACD,QAAI0D,CAAC,CAACiC,IAAF,CAAO3F,KAAP,CAAJ,EAAmB;AACjB,aAAO,IAAIiG,IAAJ,CAASjG,KAAT,CAAP;AACD;;AACD,QAAI6E,CAAC,CAACc,IAAF,CAAO3F,KAAP,CAAJ,EAAmB;AACjB,aAAOkG,MAAM,CAAClG,KAAD,CAAb;AACD;;AACD,QAAI0F,CAAC,CAACC,IAAF,CAAO3F,KAAP,CAAJ,EAAmB;AACjB,aAAOkG,MAAM,CAAClG,KAAD,CAAb;AACD;;AAED,WAAOmG,MAAM,CAACnG,KAAD,CAAb;AACD;;AArB8C,8CAuBtB2B,QAAQ,CAAC1B,WAvBa;AAAA;;AAAA;AAuB/C,2DAA+C;AAAA,UAApCwF,UAAoC;AAC7C,UAAMW,MAAM,GAAGX,UAAU,CAACrF,IAA1B;;AACA,UAAIT,gBAAgB,CAACyG,MAAD,CAApB,EAA8B;AAC5BX,QAAAA,UAAU,CAACpF,UAAX,GAAwB+F,MAAM,CAACC,KAAP,CAAa,GAAb,EAAkBhE,GAAlB,CAAsB,UAACiE,CAAD;AAAA,iBAAOP,IAAI,CAACO,CAAC,CAAC1D,IAAF,EAAD,CAAX;AAAA,SAAtB,CAAxB;AACD;AACF;AA5B8C;AAAA;AAAA;AAAA;AAAA;AA6BhD;;ACxFD;;;;;AAIe,4BAAUvB,WAAV,EAAuB;AACpC,SAAO,IAAIZ,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,QAAI,EAAEU,WAAW,YAAYzB,mBAAzB,CAAJ,EAAmD;AACjDoB,MAAAA,OAAO,CAACC,KAAR,CAAc,0BAAd;AACAN,MAAAA,MAAM;AACN;AACD;;AAED,QAAM4F,IAAI,2KAAV;AASA,QAAMnD,GAAG,GAAGjC,YAAK,CAACoF,IAAD,EAAO;AAAEnF,MAAAA,UAAU,EAAE;AAAd,KAAP,CAAjB;AACA,QAAMoF,aAAa,GAAGpD,GAAG,CAACqD,OAAJ,CAAYrG,IAAZ,CAAiB,CAAjB,EAAoBsG,WAA1C;AAEA,QAAMC,gBAAgB,GAAG,EAAzB;AAEAC,IAAAA,wBAAwB,CAACvF,WAAD,CAAxB;;AArBsC,+CAuBfA,WAAW,CAACxB,UAvBG;AAAA;;AAAA;AAuBtC,0DAA+C;AAAA,YAApC8B,QAAoC;AAC7C,YAAMkF,KAAK,GAAGC,eAAe,CAACnF,QAAD,CAA7B;AACAgF,QAAAA,gBAAgB,CAAC7E,IAAjB,CACE4B,gBAAA,CAAiBA,YAAA,CAAa/B,QAAQ,CAAC5B,GAAtB,CAAjB,EAA6C8G,KAA7C,CADF;AAGD;AA5BqC;AAAA;AAAA;AAAA;AAAA;;AA6BtCL,IAAAA,aAAa,CAACjD,SAAd,CAAwBzB,IAAxB,CAA6B4B,kBAAA,CAAmBiD,gBAAnB,CAA7B;AAEA,QAAMI,MAAM,GAAGC,QAAQ,CAAC5D,GAAD,EAAM,EAAN,EAAUmD,IAAV,CAAvB;AACA,QAAMU,IAAI,GAAGC,kBAAkB,CAACH,MAAM,CAACR,IAAR,CAA/B;AAEA7F,IAAAA,OAAO,CAACuG,IAAD,CAAP;AACD,GAnCM,CAAP;AAoCD;AAED;;;;AAGO,SAASH,eAAT,CAAyBnF,QAAzB,EAAmC;AACxC,MAAIpC,eAAe,CAACoC,QAAQ,CAAC1B,WAAV,CAAnB,EAA2C;AACzC,WAAOkH,kBAAkB,CAACxF,QAAQ,CAAC1B,WAAV,EAAuB,CAAvB,CAAzB;AACD;;AAEDe,EAAAA,OAAO,CAACoG,IAAR,CAAa,yBAAb;AACD;;AAED,SAASD,kBAAT,CAA4BlH,WAA5B,EAAyC2F,KAAzC,EAAgD;AAC9C,MAAI3F,WAAW,CAACP,MAAZ,KAAuB,CAAvB,IAA4BkG,KAAK,KAAK3F,WAAW,CAACP,MAAZ,GAAqB,CAA/D,EAAkE;AAChE,QAAM2H,IAAG,GAAGpH,WAAW,CAAC2F,KAAD,CAAvB;AAEA,WAAOlC,gBAAA,CAAiBA,YAAA,CAAa2D,IAAG,CAAC/B,MAAjB,CAAjB,EAA2CgC,iBAAiB,CAACD,IAAD,CAA5D,CAAP;AACD;;AAED,MAAMA,GAAG,GAAGpH,WAAW,CAAC2F,KAAD,CAAvB;AACA,SAAOlC,gBAAA,CACLA,kBAAA,CACEyD,kBAAkB,CAAClH,WAAD,EAAc2F,KAAK,GAAG,CAAtB,CADpB,EAEElC,YAAA,CAAa2D,GAAG,CAAC/B,MAAjB,CAFF,CADK,EAKLgC,iBAAiB,CAACrH,WAAW,CAAC2F,KAAD,CAAZ,CALZ,CAAP;AAOD;AACD;;;;;AAGA,SAAS0B,iBAAT,CAA2B7B,UAA3B,EAAuC;AACrC,WAASM,IAAT,CAAc/F,KAAd,EAAqB;AACnB,QAAMuF,IAAI,WAAUvF,KAAV,CAAV;;AACA,YAAQuF,IAAR;AACE,WAAK,QAAL;AACE,eAAO7B,eAAA,CAAgB1D,KAAhB,CAAP;;AACF,WAAK,QAAL;AACE,eAAO0D,gBAAA,CAAiB1D,KAAjB,CAAP;;AACF,WAAK,SAAL;AACE,eAAO0D,gBAAA,CAAiB1D,KAAjB,CAAP;;AACF;AACE,eAAO0D,eAAA,CAAgB1D,KAAhB,CAAP;AARJ;AAUD;;AAED,SAAOyF,UAAU,CAACpF,UAAX,CAAsBgC,GAAtB,CAA0B0D,IAA1B,CAAP;AACD;AAED;;;;;;AAIA,SAASmB,kBAAT,CAA4BK,WAA5B,EAAyC;AACvC,MAAM1E,CAAC,GAAG,kBAAV;AACA,MAAM2E,IAAI,GAAGD,WAAW,CAACE,OAAZ,CAAoB5E,CAApB,EAAuB,UAAUE,KAAV,EAAiB2E,GAAjB,EAAsB;AACxD,WAAOvB,MAAM,CAACwB,YAAP,CAAoBC,QAAQ,CAACF,GAAD,EAAM,EAAN,CAA5B,CAAP;AACD,GAFY,CAAb;AAGA,SAAOG,kBAAkB,CAACL,IAAD,CAAzB;AACD;;ACxGc,yBAAUhE,MAAV,EAAkB;AAC/B,MAAM+C,IAAI,uyCAAV;AAqCA,MAAMnD,GAAG,GAAGjC,YAAK,CAACoF,IAAD,EAAO;AAAEnF,IAAAA,UAAU,EAAE,QAAd;AAAwB0G,IAAAA,OAAO,EAAE,CAAC,KAAD;AAAjC,GAAP,CAAjB;AACA,MAAMC,aAAa,GAAG3E,GAAG,CAACqD,OAAJ,CAAYrG,IAAZ,CAAiBgF,IAAjB,CAAsB1B,4BAAtB,CAAtB;AAEA,MAAMsE,OAAO,GAAGtE,SAAA,CAAU,IAAV,CAAhB;AACA,MAAMuE,GAAG,GAAGvE,eAAA,CAAgB,KAAhB,CAAZ;AACA,MAAMwE,OAAO,GAAGxE,mBAAA,CAAoBuE,GAApB,EAAyB,EAAzB,CAAhB;AACA,MAAME,QAAQ,GAAGzE,mBAAA,CAAoBuE,GAApB,CAAjB;AACA,MAAMG,IAAI,GAAG1E,eAAA,CAAgB,MAAhB,CAAb;AACA,MAAM2E,QAAQ,GAAG3E,YAAA,CACfA,mBAAA,CAAoB0E,IAApB,EAA0B,EAA1B,CADe,EAEf1E,mBAAA,CAAoB0E,IAApB,CAFe,EAGf,CAACJ,OAAD,CAHe,CAAjB;;AAKA,OAAK,IAAMjI,GAAX,IAAkByD,MAAlB,EAA0B;AACxB,QAAM8E,IAAI,GAAG5E,eAAA,CAAgB,WAAhB,CAAb;AACA,QAAM6E,QAAQ,GAAG7E,YAAA,CACfA,mBAAA,CAAoB4E,IAApB,EAA0B,CACxB5E,cAAA,CAAeA,eAAA,CAAgB,MAAhB,CAAf,EAAwCA,eAAA,CAAgB3D,GAAhB,CAAxC,CADwB,EAGxB2D,cAAA,CACEA,eAAA,CAAgB,WAAhB,CADF,EAEEA,wBAAA,CACEA,gBAAA,CAAiBA,YAAA,CAAa,iBAAb,CAAjB,EAAkD,CAChDA,eAAA,CAAgB3D,GAAhB,CADgD,CAAlD,CADF,CAFF,CAHwB,EAYxB2D,cAAA,CACEA,eAAA,CAAgB,UAAhB,CADF,EAEEA,wBAAA,CACEA,gBAAA,CAAiBA,YAAA,CAAa,mBAAb,CAAjB,EAAoD,CAClDA,eAAA,CAAgB3D,GAAhB,CADkD,CAApD,CADF,CAFF,CAZwB,CAA1B,CADe,EAsBf2D,mBAAA,CAAoB4E,IAApB,CAtBe,EAuBf,EAvBe,CAAjB;AAyBA,QAAMzB,KAAK,GAAGrD,MAAM,CAACzD,GAAD,CAApB;AACA,QAAMyI,SAAS,GAAGhF,MAAM,CAACzD,GAAD,CAAN,CAAYqF,IAAZ,CAAiB,UAAC1C,CAAD;AAAA,aAAOA,CAAC,YAAYY,eAApB;AAAA,KAAjB,CAAlB;;AACA,QAAIkF,SAAJ,EAAe;AACbD,MAAAA,QAAQ,CAACE,QAAT,CAAkB3G,IAAlB,CAAuB4B,SAAA,CAAU8E,SAAS,CAACxI,KAApB,CAAvB;AACD;;AACD,QAAM0I,QAAQ,GAAG7B,KAAK,CAAC8B,KAAN,CAAY,CAAC,CAAb,EAAgB,CAAhB,CAAjB;;AACA,QAAI,CAAC,QAAD,EAAW,QAAX,EAAqBzF,QAArB,CAA8BwF,QAAQ,CAAClG,IAAvC,CAAJ,EAAkD;AAChD+F,MAAAA,QAAQ,CAACK,cAAT,CAAwBC,UAAxB,CAAmC/G,IAAnC,CACE4B,cAAA,CACEA,eAAA,CAAgB,QAAhB,CADF,EAEEA,wBAAA,CACEA,gBAAA,CAAiBA,YAAA,CAAa,kBAAb,CAAjB,EAAmD,CACjDA,eAAA,CAAgB3D,GAAhB,CADiD,CAAnD,CADF,CAFF,CADF;AAUD;;AAED,QAAM+I,UAAU,GAAGjC,KAAK,CAACkC,IAAN,CAAW,UAAClG,CAAD;AAAA,aAAOA,CAAC,CAACL,IAAF,KAAW,UAAlB;AAAA,KAAX,CAAnB;;AACA,QAAIsG,UAAJ,EAAgB;AACdP,MAAAA,QAAQ,CAACE,QAAT,CAAkB3G,IAAlB,CACE4B,YAAA,CACEA,mBAAA,CAAoBA,eAAA,CAAgB,UAAhB,CAApB,EAAiD,EAAjD,EAAqD,IAArD,CADF,EAEE,IAFF,EAGE,EAHF,EAIE,IAJF,CADF;AAQD;;AAED2E,IAAAA,QAAQ,CAACI,QAAT,CAAkB3G,IAAlB,CAAuByG,QAAvB;AACAF,IAAAA,QAAQ,CAACI,QAAT,CAAkB3G,IAAlB,CAAuBkG,OAAvB;AACD;;AAED,MAAMgB,OAAO,GAAGtF,YAAA,CAAawE,OAAb,EAAsBC,QAAtB,EAAgC,CAACH,OAAD,EAAUK,QAAV,EAAoBL,OAApB,CAAhC,CAAhB;AAEA,MAAMiB,eAAe,GAAGvF,iBAAA,CAAkBsF,OAAlB,CAAxB;AACAjB,EAAAA,aAAa,CAACrB,WAAd,CAA0BtG,IAA1B,CAA+BA,IAA/B,CAAoC0B,IAApC,CAAyCmH,eAAzC;AACA,MAAMlC,MAAM,GAAGC,QAAQ,CAAC5D,GAAD,EAAM,EAAN,EAAUmD,IAAV,CAAvB;AAEA,SAAOQ,MAAM,CAACR,IAAd;AACD;;ICrHoB2C,4BACnB,qCAAc;AAAA;;AACZ,OAAKrC,KAAL,GAAa,EAAb;AACD;IAGUsC,oBAAb;AAAA;;AAAA;;AACE,kCAAc;AAAA;;AAAA;AAEb;;AAHH;AAAA,EAA0CD,yBAA1C;IAMaE,uBAAb;AACE,mCAAY5G,IAAZ,EAAmC;AAAA,QAAjBqG,UAAiB,uEAAJ,EAAI;;AAAA;;AACjC,SAAKrG,IAAL,GAAYA,IAAZ;AACA,SAAKqG,UAAL,GAAkBA,UAAlB;AACA,SAAKQ,KAAL,GAAa,IAAb;AACD;;AALH;AAAA;AAAA,iCAqBe;AACX,aAAO,KAAKR,UAAL,CAAgBE,IAAhB,CAAqB;AAAA,YAAGhJ,GAAH,QAAGA,GAAH;AAAA,eAAaA,GAAG,KAAK2E,oBAArB;AAAA,OAArB,CAAP;AACD;AAvBH;AAAA;AAAA,wBAOa;AACT,UAAIpF,iBAAiB,CAAC,KAAK+J,KAAN,CAArB,EAAmC;AACjC,eAAO,KAAKA,KAAZ;AACD;;AAED,UAAMlE,KAAK,GAAG,KAAK0D,UAAL,CAAgBzD,IAAhB,CAAqB;AAAA,YAAGrF,GAAH,SAAGA,GAAH;AAAA,eACjC4E,aAAa,CAACzB,QAAd,CAAuBnD,GAAvB,CADiC;AAAA,OAArB,CAAd;;AAIA,UAAI,CAACT,iBAAiB,CAAC6F,KAAD,CAAtB,EAA+B;AAC7B,aAAKkE,KAAL,GAAalE,KAAK,CAACpF,GAAnB;AACD;AACF;AAnBH;;AAAA;AAAA;IA0BauJ,iCAAb,GACE,2CAAYvJ,GAAZ,EAA8B;AAAA,MAAbwJ,MAAa,uEAAJ,EAAI;;AAAA;;AAC5B,OAAKxJ,GAAL,GAAWA,GAAX;AACA,OAAKwJ,MAAL,GAAcA,MAAd;AACD,CAJH;;AClCA;;;;;AAIe,+BAAUnG,GAAV,EAAe;AAC5B,MAAI;AACF,QAAIoG,2BAA2B,GAAG,KAAlC;AACA,QAAMC,IAAI,GAAG,IAAIN,oBAAJ,EAAb;AAEApH,IAAAA,QAAQ,CAACqB,GAAD,EAAM;AACZpB,MAAAA,wBADY,oCACaN,IADb,EACmB;AAAA,YACRgI,UADQ,GACOhI,IAAI,CAACG,IADZ,CACrB6E,WADqB;;AAE7B,YACEhD,kBAAA,CAAmBgG,UAAnB,KACAhG,cAAA,CAAegG,UAAU,CAACrG,MAA1B,CADA,IAEAqG,UAAU,CAACrG,MAAX,CAAkBb,IAAlB,KAA2B,QAH7B,EAIE;AACAxB,UAAAA,OAAO,CAAC2I,IAAR,CAAa,mCAAb;AACAH,UAAAA,2BAA2B,GAAG,IAA9B;;AAFA,qDAIuBE,UAAU,CAACnG,SAAX,CAAqB,CAArB,EAAwB1D,UAJ/C;AAAA;;AAAA;AAIA,gEAA2D;AAAA,kBAAhD8B,QAAgD;AAAA,kBACjD5B,GADiD,GAClC4B,QADkC,CACjD5B,GADiD;AAAA,kBAC5CC,KAD4C,GAClC2B,QADkC,CAC5C3B,KAD4C;AAEzD,kBAAM6I,UAAU,GAAG,EAAnB;AACAe,cAAAA,aAAa,CAAC5J,KAAD,EAAQ6I,UAAR,CAAb;AACA,kBAAMgB,IAAI,GAAG,IAAIT,uBAAJ,CAA4BrJ,GAAG,CAACyC,IAAhC,CAAb;AACAqH,cAAAA,IAAI,CAAChB,UAAL,GAAkBA,UAAlB;AAEAY,cAAAA,IAAI,CAAC5C,KAAL,CAAW/E,IAAX,CAAgB+H,IAAhB;AACD;AAZD;AAAA;AAAA;AAAA;AAAA;;AAcA;AACD;AACF;AAvBW,KAAN,CAAR;;AA0BA,QAAIL,2BAAJ,EAAiC;AAC/BxI,MAAAA,OAAO,CAAC+D,GAAR,CAAY,OAAZ;AAEA,aAAO0E,IAAP;AACD,KAJD,MAIO;AACLzI,MAAAA,OAAO,CAACC,KAAR,CACE,6DADF;AAGD;AACF,GAvCD,CAuCE,OAAO6I,CAAP,EAAU;AACV9I,IAAAA,OAAO,CAACC,KAAR,CAAc,4BAAd;AACAD,IAAAA,OAAO,CAACC,KAAR,CAAc6I,CAAd;AACD;AACF;;AAED,SAASF,aAAT,CAAuB5J,KAAvB,EAA8B6I,UAA9B,EAA0C;AACxC,MAAInF,kBAAA,CAAmB1D,KAAnB,CAAJ,EAA+B;AAAA,QACrBqD,MADqB,GACVrD,KADU,CACrBqD,MADqB;;AAE7B,QAAIK,cAAA,CAAeL,MAAf,CAAJ,EAA4B;AAAA,UAClBb,IADkB,GACTa,MADS,CAClBb,IADkB;AAE1BqG,MAAAA,UAAU,CAAC/G,IAAX,CAAgB,IAAIwH,iCAAJ,CAAsC9G,IAAtC,CAAhB;AAEA;AACD,KALD,MAKO,IAAIkB,oBAAA,CAAqBL,MAArB,CAAJ,EAAkC;AAAA,UAC/B0G,MAD+B,GACV1G,MADU,CAC/B0G,MAD+B;AAAA,UACvBpI,QADuB,GACV0B,MADU,CACvB1B,QADuB;AAEvCkH,MAAAA,UAAU,CAAC/G,IAAX,CAAgB,IAAIwH,iCAAJ,CAAsC3H,QAAQ,CAACa,IAA/C,CAAhB;AAEAoH,MAAAA,aAAa,CAACG,MAAD,EAASlB,UAAT,CAAb;AACD;AACF;AACF;;ACnEM,SAASmB,kBAAT,CAA4BzJ,IAA5B,EAAqD;AAAA,MAAnBC,QAAmB,uEAAR,MAAQ;AAC1DQ,EAAAA,OAAO,CAAC2I,IAAR,CAAa,wDAAb;AAEAM,EAAAA,aAAa,CAAC1J,IAAD,EAAOC,QAAP,CAAb,CAA8B0J,IAA9B,CAAmC,UAAC7I,WAAD,EAAiB;AAClD8I,IAAAA,iBAAiB,CAAC9I,WAAD,CAAjB,CAA+B6I,IAA/B,CAAoC,UAAC1G,MAAD,EAAY;AAC9CxC,MAAAA,OAAO,CAAC+D,GAAR,CAAYvB,MAAZ;AAEA5C,MAAAA,EAAE,CAACwJ,SAAH,CAAaC,SAAS,GAAG,YAAzB,EAAuC7G,MAAvC,EAA+ChD,QAA/C,EAAyD,UAAUM,GAAV,EAAe;AACtE,YAAIA,GAAJ,EAAS;AACP,iBAAOE,OAAO,CAACC,KAAR,CAAcH,GAAd,CAAP;AACD;;AACDE,QAAAA,OAAO,CAAC+D,GAAR,CAAY,uBAAZ;AACD,OALD;AAMD,KATD;AAUD,GAXD;AAYD;AAEM,SAASuF,gBAAT,CAA0B/J,IAA1B,EAAmD;AAAA,MAAnBC,QAAmB,uEAAR,MAAQ;AACxDQ,EAAAA,OAAO,CAAC2I,IAAR,CAAa,iDAAb;AAEAY,EAAAA,cAAc,CAAChK,IAAD,EAAOC,QAAP,CAAd,CAA+B0J,IAA/B,CAAoC,UAAC1G,MAAD,EAAY;AAC9CxC,IAAAA,OAAO,CAAC+D,GAAR,CAAYvB,MAAZ;AACA,QAAM+C,IAAI,GAAGiE,cAAc,CAAChH,MAAD,CAA3B;AACAxC,IAAAA,OAAO,CAAC+D,GAAR,CAAYwB,IAAZ;AACD,GAJD;AAKD;AAEM,SAASkE,iBAAT,CAA2BlK,IAA3B,EAAoD;AAAA,MAAnBC,QAAmB,uEAAR,MAAQ;AACzDI,EAAAA,EAAE,CAACC,QAAH,CAAYN,IAAZ,EAAkBC,QAAlB,EAA4B,UAAUM,GAAV,EAAeC,QAAf,EAAyB;AACnD,QAAID,GAAJ,EAAS;AACPE,MAAAA,OAAO,CAACC,KAAR,CAAcH,GAAd;AACAH,MAAAA,MAAM,CAACG,GAAD,CAAN;AACA;AACD;;AAED,QAAMsC,GAAG,GAAGjC,YAAK,CAACJ,QAAD,EAAW;AAAEK,MAAAA,UAAU,EAAE;AAAd,KAAX,CAAjB;;AACA,QAAI,CAAC9B,iBAAiB,CAAC8D,GAAD,CAAtB,EAA6B;AAC3BsH,MAAAA,oBAAoB,CAACtH,GAAD,CAApB;AACD;AACF,GAXD;AAYD;AAEM,SAASuH,EAAT,CAAYpK,IAAZ,EAAqC;AAAA,MAAnBC,QAAmB,uEAAR,MAAQ;AAC1CyJ,EAAAA,aAAa,CAAC1J,IAAD,EAAOC,QAAP,CAAb,CAA8B0J,IAA9B,CAAmC,UAAC7I,WAAD,EAAiB;AAClD8I,IAAAA,iBAAiB,CAAC9I,WAAD,CAAjB,CAA+B6I,IAA/B,CAAoC,UAAC1G,MAAD,EAAY;AAC9C5C,MAAAA,EAAE,CAACwJ,SAAH,CAAaC,SAAS,GAAG,YAAzB,EAAuC7G,MAAvC,EAA+ChD,QAA/C,EAAyD,UAAUM,GAAV,EAAe;AACtE,YAAIA,GAAJ,EAAS;AACP,iBAAOE,OAAO,CAACC,KAAR,CAAcH,GAAd,CAAP;AACD;;AACDE,QAAAA,OAAO,CAAC+D,GAAR,CAAY,uBAAZ;AACD,OALD;AAOAwF,MAAAA,cAAc,CAACF,SAAS,GAAG,YAAb,CAAd,CAAyCH,IAAzC,CAA8C,UAAC1G,MAAD,EAAY;AACxD,YAAM+C,IAAI,GAAGiE,cAAc,CAAChH,MAAD,CAA3B;AAEA5C,QAAAA,EAAE,CAACwJ,SAAH,CAAaC,SAAS,GAAG,WAAzB,EAAsC9D,IAAtC,EAA4C/F,QAA5C,EAAsD,UAAUM,GAAV,EAAe;AACnE,cAAIA,GAAJ,EAAS;AACP,mBAAOE,OAAO,CAACC,KAAR,CAAcH,GAAd,CAAP;AACD;;AACDE,UAAAA,OAAO,CAAC+D,GAAR,CAAY,sBAAZ;AACA/D,UAAAA,OAAO,CAAC+D,GAAR,CAAY,OAAZ;AACD,SAND;AAOD,OAVD;AAWD,KAnBD;AAoBD,GArBD;AAsBD;;;;;;;"}